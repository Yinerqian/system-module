<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.celi.system.dict.dao.SysDictItemDao">

    <insert id="insertSysDictItem">
        insert into cii_dict_item(dict_item_id, dict_item_name, dict_item_code, dict_item_value, dict_id, remark
        , tenant_id, create_date, create_by, update_date, update_by, del_flag)
        values(#{record.dictItemId}, #{record.dictItemName}, #{record.dictItemCode}, #{record.dictItemValue}, #{record.dictId}, #{record.remark}
        , #{record.tenantId}, #{record.createDate}, #{record.createBy}, #{record.updateDate}, #{record.updateBy}, #{record.delFlag})
    </insert>

    <update id="deleteSysDictItem">
        update cii_dict_item
        set del_flag = 1,
            update_by = #{record.updateBy},
            update_date = #{record.updateDate}
        where dict_item_id = #{record.dictItemId}
    </update>

    <update id="updateSysDictItem">
        update cii_dict_item
        set update_date = #{record.updateDate},
            update_by = #{record.updateBy},
            dict_item_name = #{record.dictItemName},
            dict_item_code = #{record.dictItemCode},
            dict_item_value = #{record.dictItemValue},
            dict_id = #{record.dictId},
            remark = #{record.remark}
        where dict_item_id = #{record.dictItemId}
    </update>

    <select id="getDictItemById" resultType="com.celi.system.dict.entity.SysDictItem">
        select *
        from cii_dict_item
        where dict_item_id = #{dictItemId}
    </select>

    <select id="listDictItem" resultType="com.celi.system.dict.entity.SysDictItem">
        select *
        from cii_dict_item
        where del_flag = 0
        and tenant_id = #{filter.tenantId}
        <if test="filter.dictItemCode != null and filter.dictItemCode != ''">
            and dict_item_code like '%${filter.dictItemCode}%'
        </if>
        <if test="filter.dictItemName != null and filter.dictItemName != ''">
            and dict_item_name like '%${filter.dictItemName}%'
        </if>
        <if test="filter.dictId != null and filter.dictId != ''">
            and dict_id = #{filter.dictId}
        </if>
        <if test="filter.dictIdList != null and filter.dictIdList.size > 0">
            and dict_id in
            <foreach collection="filter.dictIdList" item="item" open="(" close=")" separator=",">
                #{item}
            </foreach>
        </if>
    </select>

    <select id="validIfHasItem" resultType="java.lang.Integer">
        select count(dict_item_id)
        from cii_dict_item
        where del_flag = 0
        and dict_id = #{dictId}
    </select>

    <select id="validDictCode" resultType="java.lang.Integer">
        select count(dict_item_id)
        from cii_dict_item
        where del_flag = 0
        and tenant_id = #{tenantId}
        <if test="dictItemId != null and dictItemId != ''">
            and ( dict_item_code = #{dictItemCode} and dict_item_id != #{dictItemId} )
        </if>
        <if test="dictItemId == null or dictItemId == ''">
            and dict_item_code = #{dictItemCode}
        </if>
    </select>

    <select id="getSysDictItemByGroup" resultType="com.celi.system.dict.entity.SysDictItem">
        select *
        from cii_dict_item
        where del_flag=0
        and dict_id=#{dictId}
    </select>

</mapper>
